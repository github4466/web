function getMousePos(t){var e=0,n=0;if(!t)var t=window.event;return t.pageX||t.pageY?(e=t.pageX,n=t.pageY):(t.clientX||t.clientY)&&(e=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:e,y:n}}function throttle(t,e){var n=!0;return function(a){n&&(n=!1,setTimeout(function(){n=!0},e),t(a))}}var EventUtil={addHandler:function(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n},removeHandler:function(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null},getEvent:function(t){return t?t:window.event},getTarget:function(t){return t.target||t.srcElement},preventDefault:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},stopPropagation:function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}};window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),function(){function t(t){return new RegExp("(^|\\s+)"+t+"(\\s+|$)")}function e(t,e){var o=n(t,e)?r:a;o(t,e)}var n,a,r;"classList"in document.documentElement?(n=function(t,e){return t.classList.contains(e)},a=function(t,e){t.classList.add(e)},r=function(t,e){t.classList.remove(e)}):(n=function(e,n){return t(n).test(e.className)},a=function(t,e){n(t,e)||(t.className=t.className+" "+e)},r=function(e,n){e.className=e.className.replace(t(n)," ")});var o={hasClass:n,addClass:a,removeClass:r,toggleClass:e,has:n,add:a,remove:r,toggle:e};window.classie=o}(),function(){function t(){var t=M.width/Z.x;w.style[Modernizr.prefixed("transform")]="scale3d("+t+","+t+",1)"}function e(){p.style[Modernizr.prefixed("transition")]="none"}function n(t){p.style[Modernizr.prefixed("transform")]=t?"translate3d(0,0,"+F+"px) rotate3d(1,0,0,"+t.rotateX+"deg) rotate3d(0,1,0,"+t.rotateY+"deg) translate3d("+t.translateX+"px, "+t.translateY+"px, "+t.translateZ+"px)":"translate3d(0,0,"+F+"px) rotate3d(1,0,0,"+V.rotateX+"deg) rotate3d(0,1,0,"+V.rotateY+"deg) translate3d("+V.translateX+"px, "+V.translateY+"px, "+V.translateZ+"px)"}function a(t){var e=t||C;p.style.WebkitTransition="-webkit-transform "+e.speed+"ms "+e.easing,p.style.transition="transform "+e.speed+"ms "+e.easing}function r(){classie.add(L,"action-shown")}function o(){classie.add(L,"action-disabled"),z=!1}function i(){classie.remove(L,"action-disabled"),z=!0}function s(t,e,n,a,r){var o=(t-e)/(n-a),i=e-o*a;return o*r+i}function l(t){o(),a();var r=window.getComputedStyle(t.parentNode,null),i=r.getPropertyValue("-webkit-transform")||r.getPropertyValue("-moz-transform")||r.getPropertyValue("-ms-transform")||r.getPropertyValue("-o-transform")||r.getPropertyValue("transform")||"Either no transform set, or browser doesnÂ´t do getComputedStyle";if("none"!==i){var l=i.split("(")[1];l=l.split(")")[0],l=l.split(",");var c=l[13],d=l[14],u=t.offsetLeft+H/2+t.offsetWidth/2,f=u<Z.x/2?Z.x/2-u:-(u-Z.x/2),m=Z.y/2-(Z.y-Math.abs(c)-t.offsetHeight)+10,v=Math.abs(d)+10,w=Z.z-A,g=w-(h-1+U)*P,y=0,E=Z.x/2,b=0,x=20,X=s(b,x,y,E,f),Y=0,q=50,S=s(Y,q,y,E,f),T=s(X,S,g,w,Math.abs(d));V={translateX:f,translateY:m,translateZ:v,rotateX:0,rotateY:T},n(),O(p,function(){e()})}}function c(t){if(classie.has(t,"row-seat-reserved"))return!1;if(classie.has(t,"row-seat-selected"))return classie.remove(t,"row-seat-selected"),!1;classie.add(t,"row-seat-selected");var e=y[x.indexOf(t)];l(e)}function d(t){a({speed:1500,easing:"ease"}),n(N),O(p,function(){e(),t.call()})}function u(){classie.remove(q,"action-shown"),Y.currentTime=0,Y.play()}function f(){classie.add(q,"action-shown"),Y.load()}function m(){var e=function(t){var e=EventUtil.getEvent(t),n=EventUtil.getTarget(e);classie.has(n,"row-seat")&&c(n)};EventUtil.addHandler(b,"click",e);var a=function(){z?o():i()};EventUtil.addHandler(L,"click",a);var s=function(t){requestAnimFrame(function(){if(!z)return!1;var e=getMousePos(t),a=V.rotateX-(2*k.rotateX*e.y/M.height-k.rotateX),r=V.rotateY+(2*k.rotateY*e.x/M.width-k.rotateY),o={translateX:V.translateX,translateY:V.translateY,translateZ:V.translateZ,rotateX:a,rotateY:r};n(o)})};EventUtil.addHandler(document,"mousemove",s);var l=function(){classie.remove(S,"intro-shown"),classie.add(b,"ticket-shown"),classie.add(q,"action-faded"),d(function(){r()})};EventUtil.addHandler(T,"click",l),EventUtil.addHandler(q,"click",u),EventUtil.addHandler(Y,"ended",f),window.addEventListener("resize",throttle(function(e){M={width:window.innerWidth,height:window.innerHeight},t()},10))}function v(){t(),n({translateX:0,translateY:0,translateZ:1300,rotateX:0,rotateY:0}),m()}var w=document.querySelector(".container"),p=w.querySelector(".cube"),g=[].slice.call(p.querySelectorAll(".seat-area > .row")),h=g.length,y=(g[0].children.length,[].slice.call(p.querySelectorAll(".row-seat"))),E=y[0].offsetWidth,b=document.querySelector(".ticket"),x=[].slice.call(b.querySelectorAll(".row-seat")),X=p.querySelector(".screen"),Y=X.querySelector("video"),q=X.querySelector("button.action-play"),S=X.querySelector(".intro"),T=S.querySelector("button.action-seats"),L=document.querySelector("button.action-lookaround"),k={rotateX:25,rotateY:15},z=!1,M={width:window.innerWidth,height:window.innerHeight},H=4*E,A=800,P=100,U=2,F=2e3,Z={x:h*E+H+U*E,y:1e3,z:3e3},C={speed:1e3,easing:"cubic-bezier(.7,0,.3,1)"},N={translateX:0,translateY:Z.y/3.5,translateZ:0,rotateX:-15,rotateY:0},V=N,W={transitions:Modernizr.csstransitions},R={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},D=R[Modernizr.prefixed("transition")],O=function(t,e){var n=function(t){if(W.transitions){if(t.target!=this)return;this.removeEventListener(D,n)}e&&"function"==typeof e&&e.call(this)};W.transitions?t.addEventListener(D,n):n()};v()}();